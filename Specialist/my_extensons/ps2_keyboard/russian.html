<html lang="ru">
<head>
<meta charset="utf-8">
</head>
<body>
<h1>Контроллер PS/2 клавиатуры</h1>

<div class="border" style="clear:right;float:right;width:346px;margin-right:0">
<div style="width:346px;height:370px;background:url(ps2_fuses.png) no-repeat center center">
</div>Фьюзы ATMega8 в Code Vision AVR</div>

<p>Этот контроллер позволяет подключить PS/2 клавиатуру к компьютеру Специалист. В контроллере
используется микроконтроллер ATMega8.</p>

<p>Лицензионное соглашение. AS IS. Вы имеете право использовать эти разработки в любых целях, если принимаете
ниже написанное условие. В случае какого-либо ущерба, возникшего по причине использования моих 
разработок, я не несу никакой ответственности. Вы можете даже удалить копирайт и выдавать их за 
свои. Но мне было бы приятнее, если копирайт остался на месте.</p>

<p>Все материалы находятся в репозитории
<a href="https://github.com/alemorf/retro/tree/master/specialist-ps2_keyboard">
https://github.com/alemorf/retro/tree/master/specialist-ps2_keyboard
</a>:</p>

<p class="item">Пошивка spec_keyb.hex для ATMega8 в формате Intel HEX, который
должен поддерживать любой программатор.</p>
<p class="item">Схема в формате PNG. Так же есть на этой странице ниже.</p>
<p class="item">Печатная плата для ЛУТ в формате DOCX (Microsoft Word).</p>
<p class="item">Исходники прошивки. Что бы их скомпилировать без лишних усилий, вам потребуется 
среда разработки Code Vision AVR.</p>
<p class="item">Схема и печатная плата в формате программы Proteus.</p>

<p>В Специалисте используется английская раскладка JCUKEN, а не привычная нам QWERTY. 
При этом русская раскладка совпадает с современной ЙЦУКЕН. Поэтому невозможно настроить 
соответствие между клавишами PS/2 клавиатуры так, что бы русская и английская надпись 
на PS/2 клавиатуре одновременно соответствовала Специалисту. Поэтому я сделал сразу два набора соответствий, 
для русской и для английской раскладки, которые переключаются клавишей Scroll Lock.</p>

<p>В компьютере Специалист MX отличаются коды некоторых клавиш (ESC, TAB, F1 - F11),
поэтому для МХ я сделал встроенную коррекцию, которая включаются клавишей Print Screen.</p>

<p>При прошивке микроконтроллера во фьюзах выберите внутренний тактовый 
генератор 8 МГц. Пример для Code Vision AVR справа.</p>


<p>Контроллер клавиатуры может выполнять сброс компьютера. Для этого при прошивке надо
установить фьюз RSTDISBL и подключить выход RESET ATMega8 к кнопке перезагрузки.
ВНИМЕНИЕ! Установив RSTDISBL вы теряете возможность перепрошить микроконтроллер
в будущем. Я советую вообще не трогать фьюз RSTDISBL или устанавливать его только 
когда контроллер работает.</p>

<div class="h2">Корректировка раскладки под себя</div>

<p>Этот контроллер может изменять соответствие клавиш РС и Специалиста во время работы. 
Для этого надо нажать на нужную кнопку и не отпуская её нажать BREAK. Светодиоды 
должны последовательно мигнуть. Затем набираете цифрами код клавиши Специалиста и нажимаете 
ENTER. Ниже указаны коды клавиш Специалиста:</p>

<img src="ps2_codes.png">

<p>Цифра 0 отвязывает кнопку. Цифра 65534 возвращает контроллер к заводским настройкам.
Цифра 65535 сохраняет изменения в энергонезависимую память. При этом, сохраняется и 
выбранная раскладка (РУС/ЛАТ и МХ/не МХ).</p>

<p>Моя прошивка содержит следующее соответствие:</p>

<img src="ps2_codes_default.png">

<p>Программа <a href="ps2_setup.htm">Настройка раскладки</a> позволяет настроить свою привязку 
клавиш перед прошивкой. Программа формирует массив чисел, который необходимо вставить в исходники,
скомпилировать исходники и прошить микроконтроллер.</p>

<div class="h2">Схема</div>

<img src="ps2_cir.png" width="100%">

<div class="h2">Готовое устройство</div>

<img src="ps2_ready.png" width="100%"><br><br>

<img src="ps2_ready2.png" width="100%">

<img src="ps2_ready3.png" width="100%">

</body>
</html>
