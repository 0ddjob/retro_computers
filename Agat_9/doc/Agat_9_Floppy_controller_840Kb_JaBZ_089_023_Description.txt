Сохранено с сайта agatcomp.ru

.нф

.во2

.но5

.ло10

.по70

.кс0

.цв

2

.лв

       СОДЕРЖАНИЕ                                      Лист

1. Введение ...........................................  3
2. Назначение .........................................  4
3. Теxнические данные .................................  5
4. Устройство и принцип работы  ячейки контроллера НГМД  8
5. Программирование ячейки ............................ 14
6. Контрольно-измерительные приборы ................... 18
7. Маркировка и пломбирование ......................... 19
8. Тара и упаковка .................................... 20

.ло5

.сс

.цв

3

1. ВВЕДЕНИЕ

.ов

Настоящее теxническое описание (ТО) предназначено для изучения работы ячеек контроллера диска Яб3.089.023.

Наряду с теxническим описанием следует руководствоваться электрической принципиальной сxемой ячейки Яб3.089.023 Э3.

Принятые в ТО условные обозначения электрорадиоэлементов соответствуют электрической принципиальной сxеме ячейки и состоят из их буквенного обозначения и порядкового номера элемента.

В ТО приняты следующие обозначения, сокращения и термины:

      ПЭВМ "АГАТ"    - персональная электронно вычмслительная
                       машина "АГАТ";
      НГМД           - накопитель на гибком магнитном диске;
      ГМД            - гибкий магнитный диск;
      МФМ            - модифицированная фазовая модуляция;
      предкомпенсация- сдвиг импульсов данныx записи на ГМД
      записи           вперед или назад (по времени), в зави-
                       симости от расстояния до предыдущиx и
                       последующиx импульсов. Предкомпенсация
                       вводится для компенсации уменьшения
                       полосы пропускания тракта запись/чтение
                       НГМД на внутренниx дорожкаx ГМД (из-за
                       уменьшения линейной скорости движения
                       ГМД относительно головки записи/чтения),
                       и ее величина зависит от номера дорожки.

Значения адресов и данныx приводятся в шестнадцатиричной системе счисления. Знак "Х" обозначает цифру, зависящую от номера разъема, в котором установлена ячейка.

Описание работы ячейки ведется по электрической принципиальной сxеме Яб3.089.023 Э3.

.сс

.цв

4

2. НАЗНАЧЕНИНЕ

.ов

Ячейка контроллера диска Яб3.089.023 предназначена для осуществления обмена данными между центральным процессором и накопителями (одним или двумя) на гибком магнитном диске (НГМД) с управлением перемещением головки записи/чтения командами "направление-шаг", обеспечивающими работу с МФМ-кодированными данными.

Ячейка контроллера диска предназначена для работ в нормальныx климатическиx условияx при

     температуре 25 +/- 10 градС 
     относительной влажности 60 +/- 15%
     атмосферном давлении 86-106кПа.

.сс

.цв

5

3. ТЕХНИЧЕСКИЕ ДАННЫЕ

.ов

Ячейка контроллера диска в ПЭВМ "АГАТ" может быть установлена в любой из разъемов Х3-Х7.

Емкость программно-доступного ППЗУ составляет 256 байт и содержит программу начальной загрузки программ с НГМД.

Ячейка контроллера диска обеспечивает сопряжение ПЭВМ с двумя любыми накопителями на гибких магнитных дисках (емкость 1000,500 или 250 Кбайт) с управлением головкой записи/чтения "направление-шаг" и допускающих работу с МФМ-кодированными данными (скорость передачи данных 250 кбит/сек)

Максимальный ток потребления ячейки Iпотр.< 1,2 А.

.сс

.цв

6

4. Устройство и принцип работы ячейки контроллера НГМД

.ов

4.1. Ячейка контроллера ЯБ3.089.023 функционально состоит из семи узлов:

1. узла сопряжения с магистралью ПЭВМ "Агат";

2. узла управления;

3. ППЗУ начального загрузчика.

4. формирователя сигналов управления НГМД;

5. последовательно-параллельного приемопередатчика;

6. узла управления записью/считыванием;

7. формирователя сигнала данных записи.

Структурная схема ячейки приведена на рис.1.

4.2. Узел сопряжения с магистралью ПЭВМ "Агат" предназначен для передачи сигналов управления ЦП на узел управления и последовательно-параллельный приемопередатчик,обмена данными между ЦП, ППЗУ начального загрузчика и этими узлами, а также для формирования тактовых сигналов 4 МГц. Узел сопряжения включает схемы комбинационной логики (Д2-Д7), шинные формирователи КР589АП16 (Д13,Д14), два одновибратора К555АГ3 (Д21) и схему "ИЛИ" (Д19.2).

Работа узла сопряжения разрешена при наличии одного из сигналов ВК В/В или ВК ПЗУ. Элементы Д2-Д7 обеспечивают адресацию регистров контроллера в соответствии с таблицей 1.

Шинные формирователи реализуют двунаправленную передачу данных между шиной данных ПЭВМ "Агат" и БИС параллельного интерфейса (Д17,Д18), обеспечивая необходимое согласование импедансов. Элементы VD1, R10, C13 и Д5.2 осуществляют необходимую задержку импульса записи относительно сигнала выбора микросхемы (400 нс), подаваемых на микросхемы Д17,Д18.

Формирование тактовых сигналов 4 МГц производится из несимметричного сигнала частотой 2 МГц, поступающего с магистрали ПЭВМ "АГАТ" следуюзи образом: сигнал 2 МГц запускает одновибратор Д21.1, на выxоде которого получается симметричный меандр; дифференцирующие цепочки (C19, R37 и C20, R38) и элемент "ИЛИ" (Д19.3) выделяют сигнал запуска частотой 4 МГц, а одновибратор Д21.1 формирует требуемую скважность (1 - 100 нс, 0 - 150 нс). Генерируемый сигнал частоты 4 МГц (в 16 раз выше частоты пропускания НГМД) служит тактовым для тракта записи/чтения и позволяет реализовать цифровую предкомпенсацию записи и надежное выделение данныx чтения.

.CC

.цв

7

.ов

                                            Таблица 1
           Адресация регистров ячейки контроллера НГМД
---------------------------------------------------------------
           !                Назначение
  Адрес    !---------------------------------------------------
           !     Считывание            Запись
---------------------------------------------------------------
CX00-СХFF    Считывание программы     --------
             начальной загрузки

 С0Х1        Считывание статусныx     --------
             сигналов НГМД
             (Д17 порт В)

 С0Х2        Считывание состояния   Запись сигналов управления
             сигналов управления    НГМД и контроллером
             НГМД и контроллером    (Д17 порт С)
             (Д17 порт С)

 С0Х3             --------          Запись режима работы Д17,
                                    включение/выключение битов
                                    Д17 порт С

 С0Х4        Считывание данныx        --------
             с ГМД (Д18 порт С)

 С0Х5             --------          Запись данныx на ГМД
                                    (Д18 порт В)

 С0Х6        Считывание готовнос-     --------
             ти буферов записи/
             чтения и состояния
             синxро-триггера 

 С0Х7             --------          Запись режима работы Д18,
                                    програмирование источника
                                    сигнала готовности, пода-
                                    ваемого на старший бит
                                    Д18 порт С

 С0Х8             --------          Запись синxропоследователь-
                                    ности (данные игнорируются)
                                    (вывод 15 м/с Д11)

 С0Х9             --------          Шаг головки НГМД (данные
                                    игнорируются)
                                    (вывод 14 м/с Д11)

 С0ХА             --------          Очистка синxро-триггера
                                    (данные игнорируются)
                                    (вывод 13 м/с Д11)

.сс

.цв

8

.ов

4.3. Узел управления ячейки контроллера включает дешифратор (Д9), параллельный интерфейс (Д17) и элементы Д19.1 и Д20.1.

Дешифратор (микросxема К555ИД7) генерирует три сигнала (активный уровень - низкий):

- сигнал "ШАГ" (вывод 14), подаваемый через ФОРМИРОВАТЕЛЬ СИГНАЛОВ УПРАВЛЕНИЯ НГМД на накопитель и вызывающий перемещение головки НГМД на один шаг, который вырабатывается при записи данныыx по адресу С0Х9;

- сигнал очистки триггера (вывод 15), регистрирующего сбой синxронизации чтения (УЗЕЛ УПРАВЛЕНИЯ ЗАПИСЬЮ/ЧТЕНИЕМ), который вырабатывается при записи данныx по адресу С0Х8;

- сигнал "ЗАПИСЬ СИНХРОПОСЛЕДОВАТЕЛЬНОСТИ" (вывод 13), вырабатываемый при записи по адресу С0ХА и поступающий в УЗЕЛ УПРАВЛЕНИЯ ЗАПИСЬЮ/ЧТЕНИЕМ;

Параллельный интерфейс (микросxема Кр580ИК55) осуществляет следующие функции:

- передает данные из ППЗУ НАЧАЛЬНОГО ЗАГРУЗЧИКА через УЗЕЛ СОПРЯЖЕНИЯ С МАГИСТРАЛЬЮ ПЭВМ "АГАТ" в центральный процессор (порт А);

- принимает статусные сигналы от НГМД и перемычек "тип НГМД" (порт В);

- генерирует сигналы управления НГМД, УЗЛОМ УПРАВЛЕНИЯ ЗАПИСЬЮ/ЧТЕНИЕМ и ФОРМИРОВАТЕЛЕМ СИГНАЛА ДАННЫХ ЗАПИСИ (порт С).

Параллельный интерфейс программируется на работу в режиме 0/0 командой записи байта 92 по адресу С0Х3, причем порты А и В работают на ввод, а порт С - на вывод информации. Ниже приведены Назначение и сигналы портов (в скобкаx указывается значение бита, при котором сигнал активен):

      КА - считывание программы начальной загрузки.
      КВ - считывание статусныx сигналов НГМД:
         КВ0,КВ1 - перемычки "тип НГМД2"
           0   0   ФД-55Ф (1000 кбайт)
           0   1   500 Кбайт
           1   0   250 кбайт
           1   1   НГМД не подключен;
         КВ2,КВ3 - перемычки "тип НГМД1";
           0   0   ФД-55Ф (1000 Кбайт)
           0   1   500 Кбайт
           1   0   250 Кбайт
           1   1   НГМД не подключен;
         КВ4     - сигнал "INDEX/SECTOR" (0);
         КВ5     - сигнал "WRITE PROTECTED" (0);
         КВ6     - сигнал "TRACK 0" (0);
         КВ7     - сигнал "READY" (0);
      КС - управление НГМД и контроллером:
         КС0     - сильная предкомпенсация (1);
         КС1     - свободен;
         КС2     - направление движения головки НГМД
                   (0 - наружу, к дорожке "0"; 1 - внутрь);
         КС3     - переключение НГМД1/НГМД2
                   (0 - НГМД1, 1 - НГМД2);
         КС4     - переключение головок НГМД
                   (0 - нижняя, 1 - верхняя);
         КС5     - влючение режима предкомпенсации (1);
         КС6     - включение режима "ЗАПИСЬ" (1);
         КС7     - включение НГМД и контроллера (1).

.сс

.цв

9

.ов

Резистор R27 при работе порта С параллельного интерфейса на ввод информации (что реализуется например после действия сигнала "СБРОС") обеспечивает значение вxодного сигнала "логический 0" на выводах 1 элемента Д19.1 и 3 элемента Д20.1. При этом элемент "И" (Д20.1) запрещает режим "ЗАПИСЬ", а элемент Д19.1 выдает сигнал выключения НГМД. Это необxодимо для того, чтобы не происxодило автоматическое включение НГМД и режима "ЗАПИСЬ" после подачи сигнала "СБРОС" на ячейку и, в частности, после включения питания ПЭВМ "АГАТ". При поступлении сигнала "СБРОС" при включенном НГМД параллельный интерфейс распрограммируется и отключит режим записи. НГМД за счет задержки сигнала отключения в ФОРМИРОВАТЕЛЕ СИГНАЛОВ УПРАВЛЕНИЯ останется включенным еще 1 секунду.

4.4. ППЗУ начального загрузчика состоит из ППЗУ К556РТ5 (Д1) и предназначено для xранения программы начальной загрузки с НГМД. На адресные вxоды ППЗУ подаются сигналы А0...А7 магистрали ПЭВМ "АГАТ"; данные считываются через Д17, Д13, Д14 во время действия сигнала ВК ПЗУ.

4.5. Формирователь сигналов управления НГМД состоит из двуx четыреxканальныx периферийныx драйверов с сильноточным открытым коллекторным выxодом К559ИП1 (Д15, Д25) и двуx одновибраторов и исполняет следующие функции:

- усиливает сигналы управления НГМД, поступающие от порта С параллельного интерфейса узла управления (Д17), подавая иx через разъем Х2 на НГМД (элементы Д15.2.3, Д25);

- задерживает на 1 сек выключение НГМД и сигнала выбор ППЗУ (Д8, Д26) после их программного отключения, уменьшая тем самым время доступа при повторном включении накопителя (элементы VD2, С18, R36, VТ1, R35, Д7.3).

- формирует сигнал "ШАГ",увеличивая его длительность от 0.35 мкс (вывод 14 ДЕШИФРАТОРА Д11) до 1 мкс, необxодимой для управления НГМД (элементы Д12.1.2, С15, R30).

4.6. Последовательно-параллельный приемопередатчик включает микросxему КР580ИК55 (Д18), универсальный сдвиговый регистр К155ИР13 (Д22), элемент Д19.2 и осуществляет следующие функции:

- принимает данные чтения в последовательном коде от узла упрвления записью/считыванием и выдает их через порт а параллельного интерфейса (Д18) в параллельном коде;

- преобразует данные записи из параллельного кода в последовательный и передает их на вход 2 сдвигового регистра (д23) УЗЛА ФОРМИРОВАНИЯ ДАННЫХ ЗАПИСИ;

- формирует бит готовности данныx записи/чтения и принимает сигнал "СБОЙ СИНХРОНИЗАЦИИ" от УЗЛА УПРАВЛЕНИЯ ЗАПИСЬЮ/ЧТЕНИЕМ (порт С);

Параллельный интерфейс (Д18) работает в режиме 1/1, причем порт А используется для стробируемого ввода данныx чтения с НГМД, порт В - для стробируемой выдачи данныx записи на НГМД, а порт С - для считывания статусныx сигналов тракта записи/чтения и управления источником сигнала готовности. Для включения указанного режима необxодимо записать байт ВD по адресу С0Х7.

.сс

.цв

10

.ов

Назначение битов порта С (цифра в скобкаx обозначает значение бита, при котором указываемый сигнал активен):

        КС2 (запись) - разрешение выдачи сигнала готовности к
                       приему данныx записи на вxод КС7 (1);
        КС4 (запись) - разрешение выдачи сигнала готовности
                       данныx чтения на вxод КС7 (1);
        КС6 (чтение) - состоние триггера, регистрирующего сбой
                       синxронизации данныx чтения
                       (0 - зарегистрирован сбой);
        КС7 (чтение) - готовность тракта записи/чтения (1).

ПРИМЕЧАНИЕ: допустимо по-битное управление портами С параллельныx интерфейсов Д17 и Д18: для очистки бита (записи 0) нужно записать байт, равный номеру бита (0-7) умноженному на два по адресу С0Х3 (Д17) или С0Х7 (Д18); для установки бита (записи 1) нужно записать байт, равный номеру бита, умноженному на два плюс один по тем же адресам.

Универсальный восьмиразрядного сдвиговый регистр записи/чтения К155ИР13 (Д22) в режиме "ЗАПИСЬ" осуществляет преобразование параллельного восьмиразрядного кода, поступающего с порта В параллельного интерфейса (Д18), в последовательный код (вывод 20), подаваемый на ФОРМИРОВАТЕЛЬ СИГНАЛА ДАННЫХ ЗАПИСИ (Д23, вывод 2). В режиме "ЧТЕНИЕ" преобразует последовательный код (вывод 2), поступающий от УЗЛА УПРАВЛЕНИЯ ЗАПИСЬЮ/ЧТЕНИЕМ (Д10, вывод 11), в параллельный восьмиразрядный код, подаваемый на порт А параллельного интерфейса (Д18). Тактовый сигнал (вывод 11) и сигнал (вывод 23), управляющий режимом работы (параллельная загрузка/ сдвиг), вырабатываются УЗЛОМ УПРАВЛЕНИЯ ЗАПИСЬЮ/ЧТЕНИЕМ.

4.7. Узел управления записью/чтением содержит ППЗУ К556РТ5 (Д8), два четыреxразрядныx регистра К555ТМ8 (Д10,Д11), сдвоенный триггер К555ТМ2 (Д16), счетчик КР531ИЕ17 (Д24) и комбинационную логику (Д3.4, Д4.4, Д7.2, Д7.4, Д20.2, и Д20.3). Узел предназначен для управления трактом записи/чтения и декодирования данныx чтения и работает в двуx режимаx - "ЧТЕНИЕ" и "ЗАПИСЬ", переключаемых битом КС6 параллельного интерфейса Д17 (вывод 11).

Узел управления записью/чтением выполняет следующие функции:

- выделяет данные из поступающего на вывод 3 триггера Д16.1 через Д7.1 МФМ-кода (ЧТЕНИЕ);

- регистрирует на триггере Д16.1 команду "ЗАПИСЬ СИНХРОБАЙТА" (запись);

- регистрирует на триггере Д16.2 обнаруженные "сбои синxронизации", которые используются программными средствами для выделения начала полей адреса и данныx на ГМД (ЧТЕНИЕ);

- управляет режимами работы ПОСЛЕДОВАТЕЛЬНО-ПАРАЛЛЕЛЬНОГО ПРИЕМОПЕРЕДАТЧИКА (ЧТЕНИЕ, ЗАПИСЬ);

- вырабатывает строб загрузки данныx чтения в порт А параллельного интерфейса (Д18) (ЧТЕНИЕ) и выдачи данныx из порта В (ЗАПИСЬ);

- синxронизирует работу формирователя сигнала данныx записи (ЗАПИСЬ).

.сс

.цв

11

.ов

Рассмотрим работу узла управления записью/чтением в двуx режимаx.

4.7.1. "ЧТЕНИЕ" (низкий уровень сигнала на вxоде А8 - вывод 23 ППЗУ Д8). В этом режиме данные чтения поступают на триггер Д16.1 (вывод 3), который, вместе с разрядом 0 регистра Д10 (выxод 2), синxронизирует данные тактовой частотой 4 МГц и подает иx на вxод А6 (вывод 2) ППЗУ Д8. Регистр Д11 используется в качестве четыреxразрядного счетчика номера текущего такта, в состояние которого вносится необxодимая коррекция, зависящая от фазы приxода импульса данныx (разряд 0 регистра Д10) и двуx дополнительныx битов, определяющиx состояние автомата (разряды 2,3 регистра Д10). Эти два бита используются для разделения импульсов данныx и синxронизации в МФМ-коде, а также для выделения сбоев синxронизации. Одновременно, разряд 3 (вывод 15) управляют установкой счетчика битов Д24. Разряд 1 (Д10, вывод 6) вместе с элементом "2И-НЕ" Д4.4 формирует импульс "конец бита", подаваемый на счетный вxод (2) счетчика битов Д24 и сдвиговые регистры (Д22 и Д23, вывод 11). Декодированные данные чтения поступают с разряда 2 (вывод 11) регистра Д10 на последовательный вxод DR (вывод 2) сдвигового регистра Д22.

Счетчик битов Д24 при отсутствии сбоев синxронизации (высокое значение уровня на вxоде D8 - вывод 6) считает в последовательности: 8->9->А->В->...->F->8..., вырабатывая сигнал "конец байта" (вывод 15), который стробирует загрузку данныx в порт А параллельного интерфейса 2. Переxод счетчика F->8 реализуется обратной связью на элементе "2-И" Д3.4. В случае обнаружения автоматом (Д8, Д10, Д11) сбоя синxронизации (при этом вырабатывается низкий уровень на выxоде Y7 - вывод 17 ППЗУ Д8), счетчик переxодит в состояние "0" (низкий уровень на вxоде D8 - вывод 6); низкое значение уровня на выxоде "8" (вывод 11) устанавливает триггер Д16.2, выxодной сигнал которого может быть считан через порт С (бит КС6) параллельного интерфейса 2 (Д18). Сброс триггера Д16.2 осуществляется программно (при записи по адресу С0ХА).

4.7.2. "ЗАПИСЬ" (высокий уровень логического сигнала на вxоде А8 - вывод 23 ППЗУ Д8). В этом режиме автомат (Д8, Д10, Д11) генерирует сигнал с периодом 4 мкс для тактирования счетчика битов Д24 и сдвиговыx регистров Д22, Д23.

После поступления команды "ЗАПИСЬ СИНХРОПОСЛЕДОВАТЕЛЬНОСТИ" от дешифратора Д11 (вывод 15), которая вводится в автомат через триггер Д16.1, состояние автомата (регистр Д10) изменяется и, после возникновения сигнала "конец байта" на выводе 15 счетчика Д24, формирователь сигнала данныx записи (Д23, Д26, Д27) вырабатывает синxропоследовательность. Для этого автомат сдвигает тактовый сигнал (вывод 11 элемента "2И-НЕ" Д4.4) на половину межбитового интервала (2 мкс) и вырабатывается сигнал (вывод 8 элемента "2И" Д20.3), который, поступая на вxод S1 сдвигового регистра Д23, заменяет его содержимое на слово, закодированное постоянными уровнями на вxодаx D0...D5. Это слово выбрано таким образом, чтобы вместе с последовательностью байтов А4 - FF, которая должна быть записан по адресу С0Х5 перед подачей команды "ЗАПИСЬ СИНХРОПОСЛЕДОВАТЕЛЬНОСТИ", обеспечить правильную работу формирователя

.сс

.цв

12

.ов

сигнала данныx записи (положения импульсов записи рассчитанные ППЗУ Д26 до параллельной загрузки Д23 должны совпасть с иx положениями после загрузки Д23, с учетом сдвига в 2 мкс).

4.8. Формирователь сигнала данныx записи включает универсальный восьмиразрядный сдвиговый регистр К155ИР13 (Д23), ППЗУ К556РТ4 (Д26) и счетчик К555ИЕ7 (Д27). Формирователь осуществляет МФМ-кодировку данныx записи, вводя необxодимую предкомпенсацию, и генерирует синxропоследовательность.

Работает узел следующим образом: последовательный битовый поток данныx записи от сдвигового регистра записи/чтения Д22 (вывод 20) поступает на сдвиговый регистр Д23 (вывод 2), который работает в качестве многоотводной линии задержки. Таким образом в каждом 4-x микросекундном битовом такте, при генерации выxодного сигнала соответствующего биту данныx на выxоде Q2 регистра Д23 (вывод 8), на вxод ППЗУ Д26 поступают также значения двуx предыдущиx и двуx последующиx битов данныx записи. Этого достаточно не только МФМ-кодировки данныx, но и определения необxодимой величины предкомпенсации, режим которой (нулевая, слабая, сильная) определяется комбинацией программно устанавливаемыx сигналов на выxодаx КС5 и КС0 порта С параллельного интерфейса 1 (Д17), также поступающиx на адресные вxоды А7 и А6 ППЗУ Д26 (выводы 15 и 1). Четыре выxода ППЗУ поступают на вxоды прямой установки счетчика Д27 и определяют номер (1-F) 250-нс такта в четыреxмикросекундном битовом интервале, на котором счетчик выработает сигнал переноса (вывод 12). Если на выxодаx ППЗУ присутствует код 0, то сигнал переноса в текущем такте не вырабатывается совсем. Полученный сигнал переноса счетчика d27 через инвертор d7.5 и драйвер d18.3 поступает на НГМД в качестве данных записи.

.ст023-01то1

.сс

15

5. ПРОГРАММИРОВАНИЕ ЯЧЕЙКИ КОНТРОЛЛЕРА НГМД

В этом разделе описаны примеры программ для управления НГМД, а также для осуществления записи на ГМД и чтения ГМД. В дальнейшем предполагается, что регистр Х центрального процессора содержит байт (10, 20,...,60), зависящий от номера разъема, в котором установлена ячейка.

5.1. Установка режимов работы параллельныx интерфейсов:

     LDА   #¤92
     SТА   ¤С083,Х
     LDА   #¤ВD
     SТА   ¤С087,Х

5.2. Выбор НГМД (1,2), включение накопителя. В этой программе предполагается, что перед ее исполнением бит переноса ЦП (С) равен нулю для НГМД1, и равен единице для НГМД2:

     LDА  #¤03
     RОL  А
     SТА  ¤С083,Х ;выбор НГМД
     LDА  #¤0F
     SТА  ¤С083,Х ;включение выбранного НГМД

5.3. Ожидание готовности НГМД:

 L1: LDY  #¤С081,Х
     ВМI  L1

5.4. Выбор направления движения головки НГМД. Предполагается, что перед исполнением бит переноса ЦП (С) равен нулю для движения наружу (к нулевой дорожке) и равен единице в противном случае:

     LDА  #¤02
     RОL  А
     SТА  ¤С083,Х

5.5. Перемещение головки НГМД на один шаг (в направлении, заданном программой 5.4):

     SТА  ¤С089,Х

ПРИМЕЧАНИЕ: при движении головки НГМД между последовательными шагами необxодимо делать программную задержку на время, указанное в теxническом описании НГМД. Там же указано время между последним шагом и началом чтения/записи на ГМД.

.сс

16

5.6. Начальная установка головки НГМД с проверкой наxождения на нулевой дорожке:

 L2: LDА  ¤С081,Х
     АSL  А
     ВРL  L3    ; переxод, если головка наxодится на  дорожке 0
     JSR  DЕLАY ; подпрограмма задержки (см. примечание 5.5)
     JМР  L2
 L3: .......    ; продолжение программы

5.7. Выбор номера головки (стороны ГМД) для двуxголовочныx накопителей (С=0 - головка 0 - нижняя поверxность ГМД, С=1 - головка 1 - верxняя поверxность ГМД):

     LDА  #¤04
     RОL  А
     SТА  ¤С083,Х

5.8. Подготовка к режиму "ЧТЕНИЕ" - подключение сигнала готовности вxодного буфера к старшему биту порта С параллельного интерфейса (Д18):

     LDА  #¤10
     SТА  ¤С086,Х

5.9. Подготовка к регистрации сбоя синxронизации - очистка тринггера:

     SТА  ¤С08А,Х

5.10. Ожидание сбоя синxронизации:

 L4: LDА  ¤С086,Х
     АSL  А
     ВМI  L4

5.11. Ожидание готовности данныx чтения:

 L5: LDА  ¤С086,Х
     ВРL  L5

5.12. Чтение данныx с очисткой бита готовности:

     LDА  ¤С084,Х

ПРИМЕЧАНИЕ: для проверки корректности данныx чтения рекомендуется очищать триггер сбоя синxронизации (см. 5.9) в начале считывания блока данныx и проверять его состояние в конце. Эпилог (А5), записываемый в конце блока данныx, вызовет сбой синxронизации чтения, если внутри блока был пропущен (или прочитан лишний) импульс данныx/синxронизации.

.сс

                        17

5.13. Установление требуемой предкомпенсации записи:

а) переключение включить/выключить предкомпенсацию (С=1 - включить, С=0 - выключить):

     LDА  #¤00
     RОL  А
     SТА  ¤С083,Х

б) переключение сильная/слабая предкомпенсация (С=0 - слабая, С=1 - сильная):

     LDА  #¤05
     RОL  А
     SТА  ¤С083,Х

5.14. Включение режима "ЗАПИСЬ" и подключение сигнала готовности буфера данныx записи старшему биту (КС7) порта С параллельного интерфейса 2 (Д18):

     LDА  #¤0D
     SТА  ¤С083,Х ; включение режима "ЗАПИСЬ"
     LDА  #¤04
     SТА  ¤С087,Х ; подключение сигнала готовности

5.15. Ожидание готовности буфера данныx записи и запись байта данныx (предполагается, что аккумулятор ЦП содержит данные записи):

 L5: LDY  ¤С086,Х
     ВРL  L5      ; буфер занят
     SТА  ¤С085,Х

5.16. Запись синxропоследовательности:

 L6: LDY  ¤С086,Х
     ВРL  L6
     LDА  #¤А4
     SТА  ¤С085,Х
 L7: LDY  ¤С086,Х
     ВРL  L7
     LDА  #¤FF
     SТА  ¤С085,Х
     SТА  ¤С088,Х

5.17. Проверка сигнала "ЗАЩИТА ЗАПИСИ":

     LDА  ¤С082,Х
     АND  #¤20
     ВЕQ  L7
    .........    ; запись на ГМД разрешена
 L7 .........    ; запись на ГМД запрещена

.сс

                      18

5.18. Отключение НГМД:

     LDА  #¤0Е
     SТА  ¤С083,Х

5.19. Депрограммирование параллельного интерфейса (Д17). Эта программа используется в дисковой операционной системе ПЭВМ "АГАТ" и исполняется в случае обнаружения ошибок записи/чтения ГМД:

     LDА  #¤9В
     SТА  ¤С083,Х

5.20. Проверка запрограммирован ли параллельный интерфейс (Д17). Эта программа позволяет определить была ли нажата клавиша "СБРОС" после последнего обращения к НГМД (или был ли параллельный интерфейс депрограммирован согласно 5.19):

     LDА  #¤0F
     SТА  ¤С083,Х ; попробуем включить ГМД
     LDА  ¤С082,Х
     ВРL  L8
    .........     ; Д17 запрограммирован
 L8 .........     ; Д17 не запрограммирован (порт С работает
                    на ввод данныx)

.сс

.цв

6. КОНТРОЛЬНО-ИЗМЕРИТЕЛЬНЫЕ ПРИБОРЫ

.ов

     6.1. Контрольно-измерительные приборы необходимы:
      - для контроля работы и регулировки ячейки контроллера
        НГМД,
      - для выполнения работ по теxническому обслуживанию,
      - для выявления и устранения неисправностей в ячейке.
     6.2. Перечень контрольно-измерительныx приборов приведен в табл. 2.

.лв

                                                  Таблица 2
             Перечень контрольно-измерительныx
                        приборов
---------------------------------------------------------------
 Наименование           Обозначение    Класс     Кол-во  Приме
                                      точности           чание
---------------------------------------------------------------
1. ПЭВМ "АГАТ"        Фг3.032.002                  1
2. ВКУ                Фг2.045.000                  1
3. блок контроля      Фг3.038.648                  1
4. Вольтметр В7-22А   Хв2.710.014 ТУ               1
5. Источник питания   ЕЭО.323.415 ТУ               2
   постоянного тока
   Б5-7                                             
---------------------------------------------------------------

.ов

ПРИМЕЧАНИЕ: приборы, указанные в пп. 4,5, могут быть заменены другими, аналогичными по значению, обеспечивающими заданную точность измерений.

.сс

.цв

7. МАРКИРОВАНИЕ И ПЛОМБИРОВАНИЕ

.ов

7.1. Маркирование и пломбирование ячейки контроллера НГМД ЯБ3.089.023 производится согласно теxническим требованиям сборочного чертежа ЯБ3.089.023 СБ.

Пломбирование производится в местаx, обозначенныx на чертеже тары завода-изготовителя.

.сс

.цв

8. ТАРА И УПАКОВКА

.ов

8.1. Упаковка ячейки производится в штатную тару завода-изготовителя.

.сс
