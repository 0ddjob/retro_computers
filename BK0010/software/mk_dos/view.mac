;VIEW.MC	PARAM-10=PRINTER
.LINK	126000
ZNGTAB=112036
V30=400		TEKPAN=402	PRENT=404	INSERT=406
INSFIL=410
STBLK=412	ENBLK=414	BUFADR=416	TEKADR=420
OSTAT=422	VERX=424	ENDBUF=426	BLVERX=430
TEKBLK=432
STEN=125672
STENA=125674	PARAM=125512	COLOR=446
VERS=120004	BLK=120006	SUBTEK=120010	SUBOLD=120011
DEVTEK=120012	SUBDIR=120013	DIR=120014	PANEL=120072
SCREEN=120074	STEK=120076	USER=120100	USER2=120114
OVERWR=120124	NAM=306		BLOK=314	SIZE=316
LD0=120134	LD1=120136	LD2=120140	DK=120131
SORTIR=120132	SY=120130	PALET=120127	
INIDR.=216	EMT6.=220	INOUT.=222	RDDIR.=224
DIRFI.=226	DIRPR.=230	FRFIN.=232	CREAT.=234
DELET=120036	SAVDI.=242	EMT20.=244	PRINA.=246
TXT=120150	OCTOU.=256	DECOU.=260	TST.=262
TST2.=264	ERROR.=266	FRFN2.=320	CRET2.=322
SELP$=0		SWAP$=2		RAMA$=4		TXT$=6
TXTA$=10	RDIR$=12	OUTP$=14	INVAD$=16
INVKR$=20	BIT16$=22	STA$=24		STA1$=26
WIN$=30		LIN$=32		KEY$=34		STR$=36
SORT$=40	FINS$=42	TX$=44		STEI$=46
TAKE$=50	ZWE$=52		NEBO$=54	CLS$=56
STWIN$=60	INF$=62		OTH$=64		OTHE$=66
ZWUK$=70	SDIR$=72	DEC$=74		C124$=76
C120$=100	IS$=102		IS1$=104	AD160$=106
OVL$=110
.WORD	51414
	TST	(PC)+
BBB:	HALT
	BNE	677
	TRAP	CLS$
	MOV	#27200,R3
	MOV	R3,@#BUFADR
	MOV	R3,@#ENDBUF
	ADD	#4000,@#ENDBUF
	TRAP	SELP$
	TRAP	TAKE$
	TRAP	TXTA$	.WORD	40201
	.ASCIZ/File:/	.EVEN
	EMT	PRINA.
	TRAP	TXTA$	.WORD	40201+30
	.ASCII<234>/P/<234>/rint /<234>/L/<234>/ines /
	.ASCII<234>/K/<234>/OI-8 /
	.ASCII<234>/A/<234>/lt. /<234>/8/<234>/0 /
	.ASCIZ<234>/6/<234>/4/		.EVEN

	MOV	#41600,R0
	MOV	#40,R2
	MOV	#125252,(R0)+
	SOB	R2,.-4

	MOV	26(R3),R4
	MOV	#4000,R0
1:	SUB	R0,R4
	BCC	1
	ADD	R0,R4
	BNE	2
	ADD	R0,R4
2:	ADD	@#BUFADR,R4
	MOV	R4,@#OSTAT
	MOV	20(R3),@#STBLK
	MOV	22(R3),R4
	BIC	#100000,R4
	ASR	R4
	ADC	R4
	ASR	R4
	ADC	R4
	MOV	R4,@#ENBLK
	MOV	R4,@#BLVERX
	MOV	SP,OLDS
	TST	PC
	BMI	677
	INC	BBB
	MOV	#27200,R4
	MOV	#126000,R5
	MOV	#4000,R2
	MOV	(R4)+,(R5)+
	SOB	R2,.-2
	JMP	@#126002
678:	MOV	@#BLVERX,@#ENBLK
677:	MOV	#-1,R4
	MOV	@#ENDBUF,R2
31K:	MOV	#14,R0
	CALL	EMT16
	CLR	KRX
	MOV	#27,R5
12:	CALL	NEXT
	BCC	12K
	CMPB	@#104,#31
	BNE	12K
	CLR	@#104
	BR	445K
12K:	TRAP	BIT16$
	BEQ	334K
	CLR	@BLK
	CLR	@#177130
334K:	MTPS	#0
	EMT	EMT6.
	CMPB	R0,#230
	BEQ	678
	CMPB	R0,#231
	BNE	444K
445K:	TST	@#ENBLK
	BEQ	446K
	INC	R4
	DEC	@#ENBLK
	BR	445K
446K:	CALL	LOADB
	MOV	@#OSTAT,R2
	INC	R2
	BR	1UNO
444K:	EMT	TST2.
	CMPB	R0,#'K
	BNE	113E
	CLR	IBM
	BR	1UNO
113E:	CMPB	R0,#'A
	BNE	114E
	INC	IBM
	BR	1UNO
114E:	CMPB	R0,#'6
	BNE	6666E
	MOV	#64.,KOLVV
	BR	1UNO
6666E:	CMPB	R0,#'8
	BNE	5555E
	MOV	#85.,KOLVV
1UNO:	MOV	#30,R5
	BR	0UNO
678$:	BR	678
5555E:	CMPB	R0,#33
	BNE	33K
6677E:	CALL	COMP
	BCS	12K
	MOV	R2,-(SP)
	MOV	#27,R2
	CLR	R1
	EMT	24
	MOV	#12,R0
	CALL	EMT16
	CLR	KRX
	MOV	(SP)+,R2
	CLR	R5
	INC	R2
	CALL	NEXT
	BCS	12K
	TRAP	BIT16$
	BEQ	6677E
	BR	12K

33K:	CMPB	R0,#31
	BNE	34K
	CALL	COMP
	BCS	12K
	INC	R2
31K2:	BR	31K
34K:	CMPB	R0,#10
	BNE	35K
	MOV	#30+30,R5

0UNO:	DEC	R2
3U:	CMP	@#BUFADR,R2
	BCS	1U
	TST	R4
	BEQ	31K
	DEC	R4
	CALL	LOADB
	INC	@#ENBLK
	MOV	@#ENDBUF,R2
1U:	MOVB	-(R2),R0
	BEQ	2U
	CMPB	#12,R0
	BNE	3U
2U:	SOB	R5,3U
	INC	R2
31K1:	CMPB	@#104,#10
	BEQ	31K2
	CLR	@#104
	BR	31K2
12K1:	BR	12K
678$$:	BR	678$
35K:	CMPB	R0,#32
	BNE	38K
	MOV	#31,R5
3D:	CMP	R2,@#BUFADR
	BHI	1D
	TST	R4
	BEQ	31K1
	DEC	R4
	CALL	LOADB
	INC	@#ENBLK
	MOV	@#ENDBUF,R2
;	INC	R2
1D:	MOVB	-(R2),R0
	BEQ	2D
	CMPB	#12,R0
	BNE	3D
2D:	SOB	R5,3D
	INC	R2
	MOV	#22,R0
	CALL	EMT16
	MOV	#32,R0
	CALL	EMT16
	CLR	KRX
	CLR	R5
	CALL	NEXT
	TRAP	BIT16$
	BNE	41D
	MOV	#2,R5
	BR	3D
41D:	MOV	#30,R5
4D:	CALL	COMP
	BCS	12K1
	CMP	R2,@#ENDBUF
	BLO	5D
	INC	R4
	CALL	LOADB
	DEC	@#ENBLK
	MOV	@#BUFADR,R2
5D:	MOVB	(R2)+,R0
	BEQ	7D
	CMPB	#12,R0
	BNE	4D
7D:	SOB	R5,4D
	DEC	R2
12K2:	BR	12K1
38K:	CMPB	R0,#'L
	BNE	39K
	MOV	R2,-(SP)
	MOV	R4,-(SP)
	MOV	@#160,-(SP)
	MOV	@#156,-(SP)
	MOV	KRX,-(SP)
	MOV	INLIN,-(SP)
	CLR	KRX
	CALL	OKNO
2626:	MOV	#30+2,R1
	MOV	#10+1,R2
	EMT	24
	MOV	#T4,R1
	CALL	E20
	MOV	@SP,R0
	MOV	#E16,SCREEN
	EMT	DECOU.
	CLR	SCREEN
	MOV	#40,R0
	CALL	E16
	EMT	EMT6.
	CMPB	R0,#32
	BNE	2627
2522:	INC	@SP
	CMP	@SP,#80.
	BHI	2521
	BR	2626
678$$$:	BR	678$$
2627:	CMPB	R0,#33
	BNE	2628
2521:	DEC	@SP
	BMI	2522
	CMP	@SP,#10
	BHIS	2628
	CLR	@SP
2628:	CMPB	R0,#3
	BNE	2630
	TST	(SP)+
	BR	2629
2630:	CMPB	R0,#12
	BNE	2626
	MOV	(SP)+,INLIN
2629:	CALL	OKNO1
	MOV	(SP)+,KRX
	MOV	(SP)+,@#156
	MOV	(SP)+,@#160
	MOV	(SP)+,R4
	MOV	(SP)+,R2
	CLR	@#104
	BR	12K2
12K3:	CLR	R0
1516:	BIT	#40400,@#177714
	BNE	12K5
	SOB	R0,1516
	BR	12K4
12K5:	MOV	#12,R0
	CALL	PR0
	MOV	#15,R0
	CALL	PR0
	MOV	#14,R0
	CALL	PR0
12K4:	MTPS	#0
	CLR	ON
	CLR	ABORT
	CLR	R0
1919:	CLR	@#104
	SOB	R0,1919
	BR	678$$$
39K:	CMPB	R0,#3
	BEQ	QUIT
	CMPB	R0,#'P
	BNE	12K2
	BIT	#40400,@#177714
	BEQ	12K2
0PRI:	MOV	#30,R5
	DEC	R2
3U$:	CMP	@#BUFADR,R2
	BCS	1U$
	TST	R4
	BEQ	31K$
	DEC	R4
	CALL	LOADB
	INC	@#ENBLK
	MOV	@#ENDBUF,R2
1U$:	MOVB	-(R2),R0
	BEQ	2U$
	CMPB	#12,R0
	BNE	3U$
2U$:	SOB	R5,3U$
	INC	R2
31K$:	MOV	#14,R0
	CALL	EMT16
	CLR	KRX
1PRI:	MOV	#1,ON
	MOV	#12,R0
	CALL	PRINT
	MOV	INLIN,R5
	BEQ	1515
	DEC	R5
	BR	2PRI
31KA:	MOV	INLIN,R5
	BNE	2PRI
1515:	MOV	#77777,R5
2PRI:	CALL	NEXT
	BCS	12K3
	TST	ON
	BEQ	12K3
	CLR	@#104
	MTPS	#0
	EMT	6
	CMPB	R0,#3
	BEQ	12K3
	BR	31KA

QUIT:	TRAP	CLS$
	MOV	#1330,@#177664
	MOV	#202,R0
	MOV	#40000,(R0)+
	MOV	#2000,(R0)+
	MOV	#40000,(R0)+
	MOV	#36000,(R0)+
	RET

OKNO:	MOV	#30,R1
	MOV	#10,R2
	EMT	24
	MOV	@#160,R3
	MOV	#30.,R2
	MOV	#EOF,R1
1:	MOV	#20,R0
2:	MOVB	(R3)+,(R1)+
	SOB	R0,2
	ADD	#100-20,R3
	BPL	3
	SUB	#40000,R3
3:	SOB	R2,1
	MOV	#T1,R1
	CALL	E20
	TRAP	AD160$	.WORD	1200-20
	MOV	#T2,R1
	CALL	E20
	TRAP	AD160$	.WORD	1200-20
	MOV	#T3,R1
E20:	MOVB	(R1)+,R0
	BEQ	1
	CALL	E16
	BR	E20
1:	RET



OKNO1:	MOV	#30,R1
	MOV	#10,R2
	EMT	24
	MOV	@#160,R3
	MOV	#30.,R2
	MOV	#EOF,R1
1:	MOV	#20,R0
2:	MOVB	(R1)+,(R3)+
	SOB	R0,2
	ADD	#100-20,R3
	BPL	3
	SUB	#40000,R3
3:	SOB	R2,1
	RET

INLIN:	.WORD	60.
ABORT:	.WORD	0
EMT16:	CALL	COBM
	CALL	PRINT
	CMPB	R0,#200
	BLO	01
	CMPB	R0,#240
	BLO	3
01:	CMPB	R0,#40
	BLO	1
	CMP	KRX,KOLVV
	BHIS	3
	CMP	KOLVV,#80.
	BLO	4
	JMP	TTOUT
4:	INC	KRX
E16:	MOV	R0,-(SP)
	MOV	R1,-(SP)
	MOV	R2,-(SP)
	MOV	R3,-(SP)
	MOV	R4,-(SP)
	MOV	R5,-(SP)
	BIC	#177400,R0
	TSTB	R0
	BPL	10
	SUB	#40,R0
10:	ASL	R0
	MOV	R0,R3
	ASL	R0
	ASL	R0
	ADD	R3,R0
	ADD	#112276-500,R0
	MOV	@#160,R3
	MOV	#100,R1
	MOVB	COLOR,R5
	BEQ	0NC
	CMP	R0,#112276
	BEQ	0NC
	MOV	#5,R2
4I:	MOVB	(R0)+,R4
	MOVB	R4,@R3
	RORB	R4
	BISB	R4,@R3
	BICB	R5,@R3
	ADD	R1,R3
	BPL	111
	SUB	#40000,R3
111:	MOVB	(R0)+,R4
	MOVB	R4,@R3
	RORB	R4
	BISB	R4,@R3
	BICB	R5,@R3
	ADD	R1,R3
	BPL	112
	SUB	#40000,R3
112:	SOB	R2,4I
	BR	20
0NC:	MOV	#5,R2
1NC:	MOVB	(R0)+,@R3
	ADD	R1,R3
	BPL	113
	SUB	#40000,R3
113:	MOVB	(R0)+,@R3
	ADD	R1,R3
	BPL	114
	SUB	#40000,R3
114:	SOB	R2,1NC
20:	CMP	KRX,#77
	BHI	30
	INC	@#160
	INC	@#156
30:	MOV	(SP)+,R5
	MOV	(SP)+,R4
	MOV	(SP)+,R3
	MOV	(SP)+,R2
	MOV	(SP)+,R1
	MOV	(SP)+,R0
	RET


1:	MOV	R5,-(SP)
	MOV	@#100016,R5
	CALL	@R5
2:	MOV	(SP)+,R5
3:	RET
KOLVV:	.WORD	64.


LOADB:	MOV	R4,-(SP)
	MOV	R5,-(SP)
	MOV	@#STBLK,R0
	ASL	R4
	ASL	R4
	ADD	R4,R0
	MOV	#2001,R1
	MOV	@#BUFADR,R2
	EMT	INOUT.
	BCC	1
	MOV	#7,R0
	MOV	R0,R1
	EMT	16
	SOB	R1,.-2
	MTPS	#0
	CLR	@#104
	EMT	6
	MOV	(SP)+,R5
	MOV	(SP)+,R4
	CMPB	R0,#3
	BNE	LOADB
	MOV	(PC)+,SP
OLDS:	HALT
	JMP	QUIT
1:	MOV	(SP)+,R5
	MOV	(SP)+,R4
	RET

COMP:	TST	@#ENBLK
	BNE	1		;BHI
	CMP	R2,@#OSTAT
	BHIS	2		;BCC
1:	TST	(PC)+
2:	SEC
	RET

NEXT:	TST	ABORT
	BNE	NEXT2
	CALL	COMP
	BCS	NEXT2	
OUTPG:	CMP	@#ENDBUF,R2
	BHI	SYM
	INC	R4
	CALL	LOADB
	DEC	@#ENBLK
	MOV	@#BUFADR,R2
SYM:	MOVB	(R2)+,R0
	BEQ	0NUL
	CMPB	#12,R0
	BEQ	0NUL
	TST	R5
	BMI	NEXT3
	CMPB	#15,R0
	BEQ	NEXT
	CMPB	R0,#40
	BHIS	0SYM
	CMPB	R0,#11
	BLO	0TAB
	BNE	NEXT
	MOV	KRX,R0
	MOV	R0,R1
	BIC	#7,R0
	SUB	R0,R1
	NEG	R1
	ADD	#10,R1
	BR	1TAB
0TAB:	MOVB	R0,R1
	CMPB	(R2),#11
	BHI	1TAB
	CLR	R0
	BISB	(R2)+,R0
	BEQ	1TAB
2T:	ASL	R0
	ASL	R0
	ASL	R0
	ADD	R0,R1
1TAB:	MOV	#40,R0
	CALL	EMT16
	SOB	R1,1TAB
	BR	NEXT

0SYM:	CALL	EMT16
	BR	NEXT
0NUL:	DEC	R5
	BMI	NEXT3
	MOV	#12,R0
	CALL	EMT16
	CLR	KRX
	BR	NEXT
NEXT3:	DEC	R2
	TST	(PC)+
NEXT2:	SEC
	RET

TTOUT:	JSR	R4,@#110346		;R0 - Code of symbol
	MOV	R5,-(SP)
	BIC	#177400,R0	;^C377
	CALL	ADRES
	TSTB	R0
	BPL	1$
	SUB	#40,R0
1$:	ASL	R0			;R0*10.
	MOV	R0,R1
	ASL	R0
	ASL	R0
	ADD	R0,R1
	ADD	#ZNGTAB-240,R1		;Adr.in	ZNGTAB

	MOV	#TOLD,R0
2$:	CMP	(R0)+,R1
	BLO	2$
	BHI	3$
	MOV	TNEW-TOLD-2(R0),R1    ;BEQ

3$:	MOV	#12,R2
4$:	MOVB	(R1)+,R0
	BIC	#177700,R0	;^C77

	ADD	R4,PC
	ASL	R0
	ASL	R0
	ASL	R0
	ASL	R0
	ASL	R0
	ASL	R0
	ASL	R0

	BICB	R5,@R3
	BISB	R0,@R3
	SWAB	R0
	SWAB	R5
	BICB	R5,1(R3)
	BISB	R0,1(R3)
	SWAB	R5
	ADD	#100,R3
	BPL	111
	SUB	#40000,R3
111:	SOB	R2,4$
	INC	KRX
KURRET:	MOV	(SP)+,R5
	JMP	@#102362

ADRES:	MOV	(PC)+,R4
KRX:	.WORD	0
	MOV	R4,R3
	ASL	R3
	ADD	R4,R3
	MOV	R3,R4
	ASL	R4
	COM	R4
	BIC	#177770,R4	;^C7
	MOV	TSMM(R4),R5
	ASL	R4
	ASR	R3
	ASR	R3
	ADD	@#160,R3
	RET

 EMT24:	MOV	R1,KRX
	CLR	R1
	CALL	@100024
	MOV	KRX,R1
	RET

EMT26:	CALL	@100026
	MOV	KRX,R1
	RET

	.ASCII<15>/¢¸´©/
	.ASCII/./<11><12>
	.ASCII/++/<0>/$¾/
	.ASCII/±³! _³³­¾/
	.ASCII/±¦-³­áâ÷çä/
	.ASCII/åöúéêëìíîï/
	.ASCII/ðòóôõæèãþû/
	.ASCII/ýÿùøüàñÁÂ×/
	.ASCII/ÇÄÅÖÚÉÊËÌÍ/
	.ASCII/ÎÏÐ¿¿¿·°¤¯/
	.ASCII/££¯¯£¹¹¹£¦/
	.ASCII/¡«¥µ®½¯¦ª¼/
	.ASCII/¨¯§²¼¬¨»¦¦/
	.ASCII/ªª¶º¹ª/
	.ASCII/ÒÓÔÕÆÈÃÞÛ/
	.ASCII/ÝßÙØÜÀÑåÅ/<57>
	.ASCII/\/<57>/\¾±/
	.ASCII/³­:+N$ /
TIBM:	.EVEN

COBM:	TST	(PC)+
IBM:	HALT
	BNE	4
	RET
4:	MOV	R2,-(SP)
	CMPB	R0,#40
	BLOS	2
	MOVB R0,R2
	BMI  1
	BIT  #140,R0
	BNE  2
	SUB  #240,R2
1:	CLR  R0
	BISB TIBM(R2),R0
2:	MOV	(SP)+,R2
	RET

TSMM:	.WORD	7700,1760,374,77    ;77*(100,20,4,1)

TOLD:	.WORD	113510,114676,114710,114746,115270
	.WORD	115340,115364,115376,115434,115446
	.WORD	115770,116040,116064

TNEW:	.WORD	S0,S1,S0,S2,S3,S4,S5,S6,S7,S8,S9,S10,S11

RAZV:
S0:	.BYTE	00,00,00,14,22,22,22,54,00,00	;á
S1:	.BYTE	00,00,00,22,52,56,52,22,00,00	;à@
S2:	.BYTE	00,00,00,34,24,24,24,76,42,00	;äD
S3:	.BYTE	00,00,00,42,42,46,52,46,00,00	;ùY
S4:	.BYTE	00,00,00,52,52,52,52,76,40,00	;ý]
S5:	.BYTE	00,00,00,06,04,34,44,34,00,00	;
S6:	.BYTE	00,22,52,52,56,52,52,22,00,00	;
S7:	.BYTE	00,22,22,22,22,22,22,76,40,00	;
S8:	.BYTE	00,34,24,24,24,24,24,76,42,00	;
S9:	.BYTE	00,42,42,42,46,52,52,46,00,00	;
S10:	.BYTE	00,42,52,52,52,52,52,76,40,00	;
S11:	.BYTE	00,06,04,04,34,44,44,34,00,00	;ÿ
T1:.ASCIZ/ªµµµµµµµµµµµµµµ£/
T2:.ASCIZ/·              ·/
T3:.ASCIZ/¦µµµµµµµµµµµµµµ¹/
T4:.ASCIZ/³­ Lines:/	.EVEN


PRINT:	TST	(PC)+
ON:	HALT
	BNE	1
3:	RET
1:	CMPB	R0,#40
	BHIS	2
	CMPB	R0,#12
	BNE	3
2:	MOV	R4,-(SP)
	MOV	R2,-(SP)
	MOV	R1,-(SP)
	MOV	R0,-(SP)
	MOVB	@#PARAM-10,R2
	BIC	#177774,R2
	ASL	R2
	MOV	TP(R2),R2
	CALL	@R2
	MOV	(SP)+,R0
	CMPB	R0,#12
	BNE	4
	MOV	R0,-(SP)
	MOV	#40,R0
	CALL	PR0
	CALL	PR0
	CALL	PR0
	CALL	PR0
	MOV	(SP)+,R0
4:	MOV	(SP)+,R1
	MOV	(SP)+,R2
	MOV	(SP)+,R4
	RET

TP:.WORD KOI7,KOI8,OSNOV,ALTER


KOI8:	JSR	R4,@#110346
	CMPB	R0,#12
	BNE	1
	MOV	#15,R0
	CALL	PR0
	MOV	(SP),R0
1:	CMPB	R0,#300
	BGE	2
	BIC	#-40,R0
	MOV	PC,R1
	ADD	#TAB-.,R1
	ADD	R0,R1
	MOVB	@R1,R0
2:	BR	PR1

KOI7:	JSR	R4,@#110346
	CMPB	R0,#12
	BNE	1
	MOV	#15,R0
	CALL	PR0
	MOV	(SP),R0
1:	CMPB	R0,#300
	BGE	2
	BIC	#-40,R0
	MOV	PC,R1
	ADD	#TAB-.,R1
	ADD	R0,R1
	MOVB	@R1,R0
2:	CLR	R2
	MOVB	R0,R1
	ASLB	R0
	ROL	R2
	CMP	R2,MEM
	BEQ	3
	MOV	#17,R0
	SUB	R2,R0
	MOV	R2,MEM
	CALL	PR0
3:	MOV	R1,R0
	BR	PR1
MEM:	.WORD	0
TAB:	.ASCII/ð- +||+== /
	.ASCII/+-||+||<+|/
	.ASCII/ -+| ++-=|/
	.ASCII/> /
PR0:	JSR	R4,@#110346
PR1:	BIC	#177400,R0
	MOV	#177714,R1
1:	MOV	(R1),R2
	MTPS	#0
	TSTB	@#105
	BEQ	4
	CLRB	@#105
	CMPB	@#104,#3
	BNE	4
	CLR	ON
	INC	ABORT
	CLR	@#104
	BR	3
4:	BIC	#137377,R2
	BEQ	1
	BIT	#4,@#PARAM-10
	BEQ	2
	COMB	R0
;	BIS	R2,R0
;	MOVB	R0,@R1
;	MOV	R0,@R1
;	MOVB	R0,@R1
;	BR	3
2:	BIS	R2,R0
	MOV	R0,(R1)
	BIT	R2,(R1)
	BNE	.-2
	BIC	R2,R0
	MOV	R0,(R1)
3:	JMP	@#102362

OSNOV:	JSR	R4,@#110346
	CMPB	R0,#12
	BNE	1
	MOV	#15,R0
	CALL	PR0
	MOV	(SP),R0
1:	TSTB	R0
	BPL	3
	BIC	#-40,R0
	BIT	#100,(SP)
	BNE	2
	MOV	PC,R1
	ADD	#TAB2-.,R1
	ADD	R0,R1
	MOVB	@R1,R0
	BR	3
2:	MOV	PC,R1
	ADD	#TAB1-.,R1
	ADD	R0,R1
	MOVB	@R1,R0
	CMPB	(SP),#340
	BCC	4
	ADD	#40,R0
4:	ADD	#60,R0
3:	JMP	PR1
TAB1:	.WORD	100236
	.WORD	113201
	.WORD	102604
	.WORD	101624
	.WORD	104225
	.WORD	105211
	.WORD	106213
	.WORD	107215
	.WORD	117617
	.WORD	110620
	.WORD	111622
	.WORD	101206
	.WORD	115634
	.WORD	114207
	.WORD	114635
	.WORD	115227
TAB2:	.WORD	124277
	.WORD	120440
	.WORD	124603
	.WORD	112243
	.WORD	20202
	.WORD	123240
	.WORD	174201
	.WORD	112652
	.WORD	173647
	.WORD	174632
	.WORD	122040
	.WORD	122636
	.WORD	121040
	.WORD	103637
	.WORD	106600
	.WORD	11576

ALTER:	JSR	R4,@#110346
	CMPB	R0,#12
	BNE	1
	MOV	#15,R0
	CALL	PR0
	MOV	(SP),R0
1:	TSTB	R0
	BPL	2
	BIC	#-40,R0
	BIT	#100,(SP)
	BNE	3
	MOV	PC,R1
	ADD	#TAB10-.,R1
	ADD	R0,R1
	MOVB 	@R1,R0
	BR	2
3:	MOV	PC,R1
	ADD	#TAB20-.,R1
	ADD	R0,R1
	MOVB	@R1,R0
	CMPB	(SP),#340
	BCC	4
	ADD	#40,R0
4:	CMPB	R0,#260
	BCS	2
	ADD	#60,R0
2:	JMP	PR1
TAB10:	.ASCII<217>/Á/<3>
	.ASCII/¿µÃÀÍÑ/<6>
	.ASCII/ÚÂÐøÅº´÷Îù/
	.ASCII<5>/Ä×³/<4>
	.ASCII/ÙØÒÏÆö±/
TAB20:	.ASCII<236><200><201>
	.ASCII<226><204><205>
	.ASCII<224><203><225>
	.ASCII<210><211><212>
	.ASCII<213><214><215>
	.ASCII<216><217><237>
	.ASCII<220><221><222>
	.ASCII<223><206><202>
	.ASCII<234><233><207>
	.ASCII<230><235><231>
	.ASCII<227><232>	.EVEN
EOF:	.END
