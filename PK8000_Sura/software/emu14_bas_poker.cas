╕ч╨л}tЙЙЙЙЙЙЙЙЙЙPOKER ╕ч╨л}t
5 GOSUB 1750
10 CLS:SCREEN 0:COLOR 1,15,15
15 KEY  OFF:LOCATE 0,10:PRINT"Желаете ли просмотреть правила(да-Y)"   
16 H$=INKEY$:IF H$="" THEN 16
17 IF H$="Y" THEN GOSUB 1500
18 CLS:INPUT"Введите количество играющих";Q
20 INPUT"Введите величину креди╕ч╨л}tта";KR
21 FOR I=1 TO Q:KR(I)=KR:NEXT
22 FOR Y=1 TO Q
28 IF KR(Y)=0 THEN 287
29 CLS:LOCATE 25,0:PRINT"Кредит-";KR(Y):LOCATE16,18:PRINT"Игрок-";Y
30 LOCATE 5,3:INPUT"Введите величину ставки";M    
31 IF M<1 THEN LOCATE10,5:PRINT"Не мелочитесь!!!":LOCAT╕ч╨л}tE 26,3:PRINT"      ":GOTO 30
35 IF M>KR(Y) THEN PRINT"Извините,но у вас недостаточно кредита.":LOCATE 26,3:PRINT"       ":GOTO 30
40 CLS
45 COLOR 1,15,15
50 LOCATE 5,0:PRINT"Ставка-";M     
52 LOCATE 16,0:PRINT"Игрок-";Y
55 KR(Y)=KR(Y)-M     
60 LOC╕ч╨л}tATE 25,0:PRINT"Кредит-";KR(Y)
69 FOR P=2 TO 30 STEP 7   
70 LOCATE P,5:N=P :GOSUB 1110
71 NEXT            
80 V$=INKEY$
90 IF V$="" GOTO 80
100 IF V$=" " GOTO 130
120 GOTO 80
130 GOSUB 3960
132 GOSUB 4010
134 GOSUB 4040
135 GOSUB 4070
136 GOSUB╕ч╨л}t 4100
140 FOR I=1 TO 5                     
145 LOCATE I*7-2,16:PRINT"?":A$=INKEY$
147 IF A$="" THEN 145
150 IF A$="O" THEN LOCATE I*7-2,16:PRINT"█":A(I)=1:GOTO 160  
155 LOCATE I*7-2,16 :PRINT" "
160 NEXT  
170 FOR I=1 TO 5
180 IF A(I)=1 THEN 195╕ч╨л}t
190 ON I GOSUB3960,4010,4040,4070,4100                      
195 NEXT  
200 GOSUB 3000
220 LOCATE 2,19:PRINT O$
230 PR=M*BO     
240 LOCATE 20,19:PRINT"Выигрыш -";PR
245 FOR I=1 TO 1250:NEXT
247 IF PR=0 THEN 275
250 FOR I=PR-1 TO 0 STEP -1
260 LO╕ч╨л}tCATE 29,19:PRINT I:LOCATE 32,0:KR(Y)=KR(Y)+1:PRINT KR(Y):BEEP
270 NEXT
275 FOR I=1 TO 1000:NEXT
280 FS=0:FL=0:ST=0:FOR I=1 TO 5:A(I)=0:NEXT
281 IF KR(Y)<>0 THEN 287
282 IF L(Y)<>0 THEN287
283 FOR I=1 TO Q:IF KR(I)<>0 THEN 285
284 NEXT:CLS:LOCATE 15,╕ч╨л}t10:PRINT"Игра окончена !                      Все банкроты !!!!":GOTO 300
285 CLS:LOCATE 13,10:PRINT"ВЫ БАНКРОТ !!!":L(Y)=1:FOR I=1 TO 2000:NEXT:IF Q=1 THEN 30O
287 NEXT Y
290 GOTO 22
300 END
500 PRINT"2":LOCATE N+4,12:PRINT"2":RETURN
510 PRINT"3":LO╕ч╨л}tCATE N+4,12:PRINT"3":RETURN
520 PRINT"4":LOCATE N+4,12:PRINT"4":RETURN
530 PRINT"5":LOCATE N+4,12:PRINT"5":RETURN
540 PRINT"6":LOCATE N+4,12:PRINT"6":RETURN
550 PRINT"7":LOCATE N+4,12:PRINT"7":RETURN
560 PRINT"8":LOCATE N+4,12:PRINT"8":RETURN
570 PRI╕ч╨л}tNT"9":LOCATE N+4,12:PRINT"9":RETURN
580 PRINT"10":LOCATE N+3,12:PRINT"10":RETURN
590 PRINT"В":LOCATE N+4,12:PRINT"В":RETURN
600 PRINT"Д":LOCATE N+4,12:PRINT"Д":RETURN
610 PRINT"К":LOCATE N+4,12:PRINT"К":RETURN
620 PRINT"Т":LOCATE N+4,12:PRINT"Т":RETUR╕ч╨л}tN
1110 PRINT"XWWWWY"
1115 LOCATE N,6
1120 PRINT"V▀▀▀▀V"      
1125 LOCATE N,7
1130 PRINT"V▀▀▀▀V" 
1135 LOCATE N,8
1140 PRINT"V▀▀▀▀V"
1145 LOCATE N,9
1150 PRINT"V▀▀▀▀V"
1155 LOCATE N,10
1160 PRINT"V▀▀▀▀V"
1165 LOCATE N,11
1170 P╕ч╨л}tRINT"V▀▀▀▀V" 
1175 LOCATE N,12
1180 PRINT"V▀▀▀▀V"
1185 LOCATE N,13
1190 PRINT"ZWWWW["
1200 RETURN
1210 PRINT"XWWWWY"              
1215 LOCATE N,6
1220 PRINT"V    V"
1225 LOCATE N,7
1230 PRINT"V    V"
1235 LOCATE N,8
1240 PR╕ч╨л}tINT"V    V"
1245 LOCATE N,9
1250 PRINT"V    V"
1255 LOCATE N,10
1260 PRINT"V    V"
1265 LOCATE N,11
1270 PRINT"V    V"
1275 LOCATE N,12
1280 PRINT"V    V"
1285 LOCATE N,13
1290 PRINT"ZWWWW["
1300 RETURN
1500 CLS:PRINT"     Инстр╕ч╨л}tукция для пользователя."
1510 PRINT:PRINT"   Итак,вы решили поиграть в покер,чтоже,мы обьясним вам,как с помощью нашейпрограммы выполнить ваше желание."
1520 PRINT"    Для начала наберите данные,которыеспросит ЭВМ (При следующих условиях:  ставка должна ╕ч╨л}tбыть больше ноля и мень-ше вашего кредита)Перед вами появилисьпять закрытых карт.Для их открытия необходимо нажать клавишу пробел.Для того,что";
1525 PRINT"бы оставить необходимые вам карты надо нажать клавишу O(в режиме лат),если не надо-нажать любую кла╕ч╨л}tвишу."
1530 PRINT"    Перейдем к рассмотрению комбинацийкарт,существующих в покере.":PRINT
1540 PRINT"PAIR OF TW╞ -две пары(2+2)карт одного ранга.Например:две дамы и две пятерки,а пятая карта любая.":PRINT     
1545 LOCATE0,22:PRINT"Для продолжения нажа╕ч╨л}tть любую клавишу."
1546 H$=INKEY$:IF H$="" THEN 1546
1550 CLS: PRINT"THREE - тройка(3)карт одного ранга.   Например:три короля,а две остальных любые.":PRINT
1560 PRINT"3+2-сочетание аналогичное PAIR OF TWO и THREE.Например:три четверки и два туза.":PRIN╕ч╨л}tT
1570 PRINT"STREET -сочетание при котором все кар-ты   стоят ступеньками со ступенькой  равной единице.Например:шесть,семь,во-семь,девять,десять.":PRINT 
1580 PRINT"FLASH -сочетание при котором все картыодной масти":PRINT
1590 PRINT"KARE -четыре карты ╕ч╨л}tодного ранга.      Например:четыре вальта и двойка.":PRINT
1600 PRINT"FLASH-STREET - комбинация,полученная  совмещением FLASHа и STREETа.":PRINT
1610 LOCATE 0,22:PRINT"Для продолжения нажать любую клавишу."
1620 H$=INKEY$:IF H$="" THEN 1620
1630 CLS:PR╕ч╨л}tINT"    Теперь поговорим о призовых выпла-тах в зависимости от сочетания(на еди-ничную ставку)."
1640 PRINT:PRINT"       PAIR OF TWO -  2*1"
1650 PRINT:PRINT"       THREE       -  3*1"
1660 PRINT:PRINT"       3+2         -  5*1"
1670 PRINT:PRINT"      ╕ч╨л}t STREET      - 10*1"
1680 PRINT:PRINT"       FLASH       - 15*1"
1690 PRINT:PRINT"       KARE        - 20*1"
1700 PRINT:PRINT"       FLASH-STREET- 25*1":PRINT
1702 PRINT"Примечание:все эти выплаты начисляютсяавтоматически."
1710 LOCATE 10,20:PRINT"ЖЕЛ╕ч╨л}tАЕМ УДАЧИ !!!"
1720 LOCATE 0,22:PRINT"Для выхода нажмите любую клавишу."
1730 H$=INKEY$:IF H$="" THEN 1730
1740 RETURN
1750 CLS:COLOR 9,2,7:SCREEN 2:LINE(0,180)-(120,0),1:LINE(256,180)-(136,0),1
1751 FOR J=0 TO 6:Y=8/5*SQR(36.01-J^2):PSET(195+J,110+Y)╕ч╨л}t,5:PSET(195+J,110-Y),5:PSET(195-J,110-Y),5:PSET(195-J,110+Y),5:NEXT
1752 FOR I=0 TO 4:PSET(194,107+I),5:PSET(196,107+I),5:NEXT:PSET(195,106),5
1753 FOR I=0 TO 4:PSET(193+I,112),5:NEXT
1760 FOR I=1 TO 8
1770 LINE(0,190)-(50,120),I
1780 LINE(50,120)-(80╕ч╨л}t,120),I:LINE(80,120)-(48,190),I:LINE(48,190)-(27,190),I
1790 LINE(27,190)-(55,140),I:LINE(55,140)-(50,140),I:LINE(50,140)-(20,190),I:LINE(20,190)-(0,190),I
1800 LINE(55,190)-(83,120),I+1:LINE(83,120)-(113,120),I+1:LINE(113,120)-(103,190),I+1:LINE(103,190╕ч╨л}t)-(55,190),I+1 
1810 LINE(76,180)-(88,140),I+1:LINE(88,140)-(95,140),I+1:LINE(95,140)-(85,180),I+1:LINE(85,180)-(76,180),I+1
1820 LINE(109,190)-(116,120),I+2:LINE(116,120)-(128,120),I+2:LINE(128,120)-(127,145),I+2:LINE(127,145)-(132,120),I+2:LINE(132,120╕ч╨л}t)-(143,120),I+2
1830 LINE(143,120)-(138,150),I+2:LINE(138,150)-(152,190),I+2:LINE(152,190)-(137,190),I+2:LINE(137,190)-(125,155),I+2
1840 LINE(125,155)-(123,190),I+2:LINE(123,190)-(109,190),I+2
1850 LINE(159,190)-(144,120),I+3:LINE(144,120)-(177,120),I+╕ч╨л}t3:LINE(177,120)-(180,134),I+2:LINE(180,134)-(170,134),I+3
1860 LINE(170,134)-(174,147),I+3:LINE(174,147)-(179,147),I+3:LINE(179,147)-(185,163),I+3:LINE(185,163)-(179,163),I+3
1870 LINE(179,163)-(185,175),I+3:LINE(185,175)-(198,175),I+3:LINE(198,175)-(205╕ч╨л}t,190),I+3:LINE(205,190)-(159,190),I+3
1880 LINE(210,190)-(180,120),I+4:LINE(180,120)-(204,120),I+4:LINE(204,120)-(232,160),I+4:LINE(232,160)-(216,160),I+4
1890 LINE(216,160)-(231,190),I+4:LINE(231,190)-(210,190),I+4:LINE(195,130)-(200,130),I+4:LINE(200,1╕ч╨л}t30)-(215,155),I+4:LINE(215,155)-(209,155),I+4
1900 LINE(209,155)-(195,130),I+4
1910 NEXT
1920 FOR I=1 TO 1000:NEXT:RETURN
2510 PRINT"CC"
2515 LOCATE N+2,9
2520 PRINT"CC"
2525 LOCATE N+2,10
2530 PRINT"CC"
2540 RETURN      
2550 PRINT"DD"
╕ч╨л}t2555 LOCATE N+2,9
2560 PRINT"DD"
2565 LOCATE N+2,10
2570 PRINT"DD"
2580 RETURN
2590 PRINT"EE"
2595 LOCATE N+2,9
2600 PRINT"EE"
2605 LOCATE N+2,10
2610 PRINT"EE"
2620 RETURN
2630 PRINT"FF"
2635 LOCATE N+2,9
2640 PRINT"FF"
2645 LO╕ч╨л}tCATE N+2,10
2650 PRINT"FF"
2660 RETURN
3000 IF NM(1)<>NM(2) THEN 3050
3010 IF NM(1)<>NM(3) THEN 3050
3020 IF NM(1)<>NM(4) THEN 3050
3030 IF NM(1)<>NM(5) THEN 3050
3040 FS=1:FL=1
3050 FOR I=1 TO 4
3060 FOR J=1 TO 4
3070 IF NK(J)<NK(J+1) THEN NK(╕ч╨л}tJ)=NK(J+1):NK(J+1)=NZ(J)
3075 NZ(J)=NK(J):NZ(J+1)=NK(J+1)
3080 NEXT  
3090 NEXT  
3100 FOR I=2 TO 5 
3110 IF (NK(I-1)-NK(I))<>1 THEN Z=I-1:GOTO 3170
3120 NEXT   
3140 FS=FS+1:ST=1
3150 IF FS=2 THEN O$="FLASH-STREET":BO=25:RETURN     
3160 IF FS=1 ╕ч╨л}tAND ST=1 THEN O$="STREET":BO=10:RETURN      
3170 IF FS=1 AND FL=1 THEN O$="FLASH":BO=15:RETURN     
3180 IF Z=4 THEN O$="NOTHING":BO=0:RETURN     
3185 K=1:SP(1)=1:SP(2)=1:SP(3)=1
3190 FOR I=Z TO 4
3200 IF NK(I)=NK(I+1) THEN SP(K)=SP(K)+1:GOTO 3220
╕ч╨л}t3210 IF I=Z THEN 3220
3215 IF SP(K)<>0 THEN K=K+1
3220 NEXT I
3227 IF K=4 THEN 3250
3228 IF K=3 THEN 3280
3230 IF K=2 THEN 3260
3241 IF K=1 AND SP(1)=3 THEN O$="THREE":BO=3:RETURN     
3246 IF K=1 AND SP(1)=4 THEN O$="KARE":BO=30:RETURN      
3250 ╕ч╨л}tZ=4:GOTO 3180
3260 IF SP(1)=3 AND SP(2)=2 OR SP(2)=3AND SP(1)=2 THEN O$="3+2":BO=5:RETURN
3270 IF SP(1)=2 AND SP(2)=2 THEN O$="PAIR OF TWO":BO=2:RETURN
3280 IF SP(1)=3 OR SP(2)=3 OR SP(3)=3 THEN O$="THREE":BO=3:RETURN
3290 IF SP(1)=2 AND SP(2)=2 OR SP(╕ч╨л}t1)=2 AND SP(3)=2 OR SP(2)=2 AND SP(3)=2 THEN O$="PAIR OF TWO":BO=2:RETURN
3300 GOTO 3250
3960 A=INT(RND(1)*52)
3970 IF A=0 THEN 3960
3980 IF A=B OR A=C OR A=D OR A=E GOTO 3960                               
3990 LOCATE 2,5:O=A:N=2:GOSUB 5000
4000 RA=╕ч╨л}tRO:MA=MO:NM(1)=MA:NK(1)=RA:NZ(1)=RA                      
4004 LOCATE4,8:GOSUB 5070
4007 RETURN
4010 B=INT(RND(1)*52)
4015 IF B=0 THEN 4010
4020 IF B=A OR B=C OR B=D ORB=E GOTO 4010
4030 LOCATE9,5:O=B:N=9:GOSUB 5000
4032 RB=RO:MB=MO:NK(2)=RB:NZ(2)=R╕ч╨л}tB:NM(2)=MB                       
4034 LOCATE11,8:GOSUB 5070
4036 RETURN
4040 C=INT(RND(1)*52)
4045 IF C=0 THEN 4040
4050 IF C=A OR C=B OR C=D OR C=E GOTO 4040
4060 LOCATE16,5:O=C:N=16:GOSUB 5000
4062 RC=RO:MC=MO:NK(3)=RC:NZ(3)=RC:NM(3)=MC          ╕ч╨л}t            
4064 LOCATE18,8:GOSUB 5070
4066 RETURN
4070 D=INT(RND(1)*52)
4075 IF D=0 THEN 4070
4080 IF D=A OR D=B OR D=C OR D=E GOTO 4070
4090 LOCATE23,5:O=D:N=23:GOSUB 5000
4092 RD=RO:MD=MO:NK(4)=RD:NZ(4)=RD:NM(4)=MD                     
4094 LOC╕ч╨л}tATE25,8:GOSUB5070
4096 RETURN
4100 E=INT(RND(1)*52)
4105 IF E=0 THEN 4100
4110 IF E=A OR E=B OR E=C OR E=D GOTO 4100
4120 LOCATE30,5:O=E:N=30:GOSUB 5000
4122 RE=RO:ME=MO:NM(5)=ME:NK(5)=RE:NZ(5)=RE
4124 LOCATE32,8:GOSUB5070
4126 RETURN
5000 IF O<=1╕ч╨л}t3 THEN MO=1:GOTO 5050
5010 IF O<=26 THEN MO=2:GOTO 5050
5020 IF O<=39 THEN MO=3:GOTO 5050
5040 MO=4
5050 RO=O-13*(MO-1)
5060 GOSUB 1210
5062 LOCATE N+1,6
5063 ON RO GOSUB 500,510,520,530,540,550,560,570,580,590,600,610,620
5065 RETURN
5070 ON MO G╕ч╨л}tOSUB2510,2550,2590,2630
5075 RETURN
