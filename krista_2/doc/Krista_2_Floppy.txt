		Методика сборки и настройки контроллера
			дисковода "Spase-Gepard"


	1. Краткое описание работы контроллера НГМД

	ПЭВМ передает информацию контроллеру и получает обратно, работая с ним,
как с внешним устройством,  для чего используется шина данных,  младшие разряды
шины адреса,  сигналы чтение устройства ввода-вывода (ЧТВВ)  и запись в устрой-
ство ввoда-вывода (ЗПВВ)  и сигнал "системный сброс",  переводящий все  м/сх  в
исходное состояние.
	Когда ПЭВМ хочет обратиться к КНГМД для записи или считывания  информа-
ции,  она выставляет на шину адреса код (адрес)  контроллера и сигнал ЗПВВ  или
ЧТВВ, в зависимости от направления передачи информации.  Этот код дешифрируется
м/сх DD3 и DD4 контроллера и,  если он совпадает с адресом КНГМД и присутствует
сигнал ЗПВВ или ЧТВВ, появляется низкий уровень на выв. 6 м/с DD11, обеспечива-
ющий включение КР1818ВГ93 в работу (сигнал CS).
	На элементах DD10.1 и DD10.2 собран тактовый генератор КНГМД,  с выхода
которого прямоугольные импульсы частотой 4 (8,  16)  мГц поступают  на  счетчик
DD8, на выводах которого появляются сигналы с частотами 4 и 1 мГц.
	М/с DD1 представляет собой два одновибратора,  один из которых  (DD1.1)
формирует из импульсов,  приходящих с магнитной  головки  дисковода,   импульсы
данных, поступающих непосредственно на вход DRD  (чтение данных)  м/с ВГ93 и на
выв. 11 счетчика DD9,  формирующего импульсы "строб данных",  также поступающие
на ВГ93.  Длительность импульса DRD  зависит от цепочки R5C10.  Для обеспечения
устойчивого считывания данных иногда возникает необходимость (но  очень  редко)
подбора конденсатора C10 под конкретную БИС ВГ93.
	Второй одновибратор DD1.2 обеспечивает запуск двигателя  дисковода  при
обращении компьютера к контроллеру. Длительность запуска после одного обращения
определяется цепочкой R6C9.
	Элементы DD10.3 и DD10.4 выполняют функцию дешифратора,   определяющего
выбор накопителя. На его входы 9 и 13 поступают сигналы с м/с DD5, определяющие
выбор дисковода, они всегда противоположны. Т.о., низкий уровень может появить-
ся только на одном из выходов DD10 - 8 или 13,  если  к  тому  же  присутствует
высокий уровень на выв. 10 и 12, т.е.  только одновременно с запуском двигателя
НГМД.
	М/с DD6 - это регистр сдвига,  формирующий сигнал данных для записи  на
диск.
	М/с DD5 представляет собой регистр слова состояния. В него записываются
сигналы,  определяющие номер выбранного накопителя (выв.  13 и 14,  15),  выбор
головки дисковода (выв. 5, 7) и признак,  указывающий,  будет ли в записи учас-
твовать сигнал ЗПЗУ (выв. 4, 2; это явл. важным только для ПЭВМ "Криста-2").


	2. Сборка и настройка контроллера

	Желательно иметь заземленный паяльник, работающий от 12 или 24 вольт. В
качестве флюса нужно использовать спиртоканифоль - пайка будет  гораздо  качес-
твенней и аккуратней. Ее легко приготовить - нужно растворить 1 куб. см.  кани-
фоли в 30 гр. спирта. Киньте его туда и раз в 15 мин. помешивайте. Часов за 4-5
он растворится.  Кисточкой смазывайте место пайки и паяйте.  Олово тогда  будет
проникать сквозь отверстия платы.
	Перед началом сборки проверьте плату на отсутствие закороток и разрывов
дорожек.
	Оптимальная последовательность сборки:
	1. Запаять всю "мелочь" - резисторы,  конденсаторы,  кварц.  Установить
перемычки S1 (их расположение для разных кварцев см.  на схеме).   Конденсаторы
C3-C8 - блокировочные - емкостью 0,047-0,1 мкф, C10 не нужен.
	2. Запаять системный раз"ем "Вектора". Будьте внимательны - у него есть
"ключи".  Лучше запаять его перпендикулярно плате - это и проще (не гнуть выво-
ды)  и удобней - контроллер будет стоять вертикально,  не занимая  пространство
позади компьютера.
	3. Запаять все м/сх, кроме ВГ93.
	4.  Соединить проводком 5-вольтовую шину КД со 2-м или  44-м  контактом
раз"ема (питание ПОКА от ПЭВМ, перед установкой ВГ93 эту пермычку убрать!), это
нужно только для предварительной проверки микросхем и отсутствия  "залипух"  на
плате после пайки. Промойте плату спиртом или ацетоном.
	5.  Подключите этот полусобранный КД к ПЭВМ,  включите ее.  Если он  не
дает работать ПЭВМ - либо есть замыкания на шине адреса, данных (от конт. 3-10,
25-32 раз"ема и далее их прохождение по плате), либо неисправны м/сх DD2,  DD3,
DD4 или DD5. Кстати,  если Вы не уверены в исправности всех м/сх,  то указанные
м/сх можете запаивать по одной, каждый раз проверяя их включением ПЭВМ.
	Если у Вас есть осциллограф,  можете проверить работу тактового генера-
тора. Кварц должен возбуждаться,  на выв.  6 DD10 должна присутствовать частота
кварца. Проверьте м/с DD8. В точках b1 и b2 (пермычка S1)  должны быть импульсы
частотой 4 и 1 мГц.
	Полезно здесь же слегка проверить работу м/сх DD2 и DD7 - нормально  ли
они инвертируют сигналы.
	6. Теперь самое муторное - приделать хвост,  то бишь дисковый шлейф,  к
контроллеру. Сначала обработайте конец шлейфа,  который будет соединяться с КД.
Прорежьте каждую жилку на 15 мм. Конец каждой жилки зачистите на 1-2 мм,  лучше
не залуживать.
	Теперь постарайтесь очень аккуратно запаять все жилы шлейфа  в  двойной
ряд отверстий вверху платы.  16 отв.  сверху и 14 снизу.  Как видно  по  плате,
верхний ряд отверстий - общие провода (14 шт.)  и два отв.  - питание (5  и  12
в.),  нижний ряд - сигнальные (кроме 4-х крайних под конденсаторы).   Они  идут
парами, сигнальный - общий, сигнальный - общий и т.д. Всего, значит, 30 жил. 14
общих, 14 сигнальных, один - 5в. и один - 12 в.
	После того,  как раз десять прицелитесь,  наберитесь терпения не менее,
чем на час и не спеша, не нервничая, соедините шлейф с платой.
	7. Теперь займитесь другим концом шлейфа.  На интерфейсном раз"еме НГМД
номера общих контактов - нечетные,  сигнальных - четные.  Контакты с первого по
седьмой вообще не используются.  Начинаем с 8-го и по 34-й (27 контактов).   На
плате КД жила, идущая на 34-й контакт раз"ема НГМД,  находится рядом с плюсовой
ногой конденсатора C2. За ней еще 3 жилы - это, соответственно, общий,  +5в.  и
+12в.  (самый крайний).  Эти три крайних жилы со  стороны  раз"ема  НГМД  нужно
отделить от остальных на 10-15 см.,  они будут  соединены  с  раз"емом  питания
НГМД.  Оставшиеся 27 жил зажимайте в раз"ем НГМД.  Это тоже  нелегко  (проще  с
помощью тисков - после того, как "наживулите" на раз"ем, обожмите его тисками).
	Теперь соедините питающие провода с раз"емом по питанию НГМД.  Сразу же
предусмотрите отвод к раз"ему на блок питания дисководов (БПД). Т.е.  к каждому
контакту раз"ема НГМД нужно припаивать пару проводов - один от шлейфа, другой к
БПД. На раз"еме НГМД два средних контакта - общий,  внешний - 12в.,  внутренний
(ближний к интерфейсному раз"ему) - 5в. Если раз"ем пронумерован, то номера:  1
- 12в.; 2,3 - общий; 4 - 5в.
	8. После того, как все соорудили,  ОБЯЗАТЕЛЬНО проверьте место соедине-
ния шлейфа с платой КД с помощью тестера (Ц-шка,  мультиметр),   чтобы  никаких
нигде замыканий. Проверьте на отсутствие замыканий по питанию.
	9. Уберите соединение 5-вольтовой шины КД с конактами 2 (44) системного
раз"ема (п. 4). Теперь КД будет питаться от блока питания дисководов.  Осталось
запаять ВГ93.  Но не торопитесь.  Подключите теперь весь комплекс - контроллер,
дисковод, БПД. Включите ПЭВМ.
	Теперь при включении БПД должен кратковременно загореться светодиод  на
дисководе и закрутиться мотор.  Иногда (в зависимости от марки НГМД),  нужно  в
дисковод всунуть дискету и закрыть его карман.  Для этой  цели  не  надо  брать
системную дискету из комплекта, лучше любую другую (чистую,  неформатированную,
негодную и т.п.).  Если мотор не работает (дискета не вращается)  - либо DD1 не
работает,  либо конденсатор C9 дохлый.  Можно это хозяйство проверить еще  так:
коснитесь пинцетом 9-й ноги м/с DD1,  должен загореться светодиод на  НГМД,   а
если дискета всунута и карман закрыт - должен завертеться мотор.  Если не так -
попробуйте сначала заменить C9. Если мотор крутится,  а светодиод НГМД не горит
- виновата DD10 (тогда наверняка и тактовый генератор не работает), либо DD5.
	Обязательно проверьте наличие на соответствующих контактах ВГ93 питания
(21 выв. - 5в., 40 выв. - 12в.).
	10. Если все o'key  - запаивайте ВГ93 и отмывайте плату.  Неисправности
гораздо лучше искать на чистой плате.
	11. Все подсоедините и включите. Но системную дискету пока не всовывай-
те. Нажмите ВВОД-БЛК. Должна опознаться ВГ93 и пойти обращение к дисководу (см.
п.9).  Если  же  Вы  при  этом выходите на магнитофонный  загрузчик - проверьте
питание на всех микросхемах.  Если опять все в норме,  но ничего  не  работает,
проверьте контроллер программой ТEST  на магнитофонной кассете (если она у  Вас
есть).  Эта программа работает под Монитором-Отладчиком,  а еще лучше,  если Вы
заменили Нач.  Загрузчик на наше ПЗУ РФ4.  Там есть монитор,  и программа  ТEST
будет под ним работать.  Только загружайте теперь не первые  ее  копии  (формат
записи Монитора-Отладчика), а вторые (формат BIOS  3.00).  Если и она Вам никак
не помогла - вздохните глубоко, возьмите в руки КД и очень внимательно,  милли-
метр за миллиметром, хорошо с лупой, осмотрите его весь.
	Соединять и отсоединять КД с ПЭВМ только при отключенном питании ПЭВМ и
НГМД !!!

	Примерная статистика сборки КД у нас на ИСПРАВНЫХ микросхемах из расче-
та на 30 контроллеров:
	20 штук запускается сразу.
	8 штук не сразу из-за неаккуратности при пайке.
	2 штуки - тут самые разные причины (непорядок в шлейфе, пережиг микрос-
хемы, дохлый резистор, конденсатор, кварц и пр.).

	Примечание: м/схемы могут быть серии 155,  555 или 1533.  Но - резистор
R6 и C9 рассчитаны на 155АГ3. Если будет 555АГ3, то придется подбирать резистор
R6 где-то в районе 30-40 Ком.


				Удачи !
